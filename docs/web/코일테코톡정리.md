# 웹 소켓

## 웹소켓이란?

> 두 프로그램사이의 메시지를 교환하기 위한 통신 방법 중 하나

- HTML5에서 많이 사용된다

## 웹소켓의 특징

1. 양방향 통신

- 데이터 송수신을 동시에 처리할 수 있는 통신방법
- 클라이언트-서버가 데이터를 원할 떄 주고 받을 수 있다

- 통상적인 HTTP 통신은 클라이언트가 요청할 때만 서버가 응답하는 단방향 통신

2. 실시간 네트워킹

- 웹 환경에서 연속된 데이터를 빠르게 노출
- 여러 단말기에 빠르게 데이터를 교환

## 비슷한 Polling

- 서버로 일정 주기 요청 송신

- 불필요한 request와 connection을 생성
- realtime 통신시 통신이 언제 발생할지 예측이 불가능

- 애매한 실시간성

## Long Polling

- 클라이언트가 서버에 요청을 보내고 응답을 받을 때 까지 연결을 종료하지 않음
- 응답을 받으면 연결을 끊고 다시 재요청
- 많은 양의 메시지가 쏟아질 경우 polling과 같게됨

## Streaming

- 클라이언트가 서버에 요청을 보내고 끊임없는 연결상태로 계속해서 데이터를 수신
- 클라이언트가 서버로 데이토 송신이 어렵다

* Polling, Long Polling, Stream 모두 불필요한 Header 크기를 가짐

# 웹소켓 동작 방법 - 핸드 쉐이킹

## Request Header

## Response Header

## 핸드쉐이크가 완료되면 데이터를 주고받음

- 프로토콜이 ws(wss)로 변경됨
-

### Message : 여러 frame이 모여 구성하는 하나의 논리적 메시지 단위

### frame : Communicaion에서 가장 작은 단위의 데이터, 작은 헤더 + payload로 구성

# 프레임이란?

## 프레임 헤더 구조

# 웹 소켓 프로토콜 특징

- 최초 접속에서만 http 프로토콜 위에서 handshakiing 하기 때문에 http header를 사용
- 웹소켓을 위한 별도의 포트는 업속, 기존포트 (http80, https-443)을 사용
- 프레임으로 구성된 메시지라는 논리적 단위로 송수신
- 메시지에 포함될 수 있는 교환 가능한 메시지는 텍스트와 바이너리

# 웹소켓의 한계

- HTML5에서 나옴

## HTML5이전에서는??

## Soket.io

- 이전의 기술로 구현된 서비스에서 웹 소켓처럼 사용할 수 있는 기술

- JS를 이용하여 브라우저 종류에 상관없이 실시간 웹을 구현

- 브라우저와 웹 서버의 종류와 버전을 파악하여 가장 적합한 기술을 선택하여 사용

##

- 웹 소켓은 문자열들을 주고 받을 수 있을 뿐 그이상의 일X
- 주고 받은 문자열의 해독은 온전히 APP에 맡김
- HTTP는 형식을 정해두었기 때문에 모두가 약속을 따르기만 하면 해석할 수 있다
- 웹소켓은 형식이 정해져 있지 않기 때문에 어플리케이션에서 해석하기 힘듬
- sub-protocol을 사용하여 메시지형태를 약속

## STOMP

- STOMP는 채팅 통신을 하기 위한 형식을 정의
- HTTP와 유사하게 정의되어 해석하기 위한 프로토콜
- 일반적으로 웹 소켓 위에서 사용됨
- 프레임 기반의 프로토콜
- 프레임은 명령,바디,헤더로 구성되어 있음
