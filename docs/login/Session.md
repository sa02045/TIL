# 세션

## 정의

| Client <-> 서버간의 네트워크 연결이 지속유지되고 있는 상태

## 사실

- Client가 서버에 Request를 보내면 서버는 Client에게 세션 ID를 부여한다.
- 세션ID를 통하여 서버는 Client를 구분한다.
- 서버에 정보가 저장되기 때문에 Client에 정보를 저장하는 쿠키보다 보안이 우수하다

## 동작 방식

1. Client가 서버에 접속하면 세션ID를 발급 받음
2. Client는 발급받은 세션ID를 쿠키로 저장함
3. Client가 서버로 Request할 떄 이 쿠키의 세션 ID를 같이 Request

`세션쿠키`

### 세션쿠키의 expires

| expires/max-age 는 쿠키의 만료 시간을 정해줍니다. 이 옵션이 없으면 브라우저가 닫힐 때 쿠키도 같이 삭제됩니다(세션쿠키)

### 세션 아이디는 어떻게 구성되나?

1. 세션아이디는 세션동안 사용자를 기억할 수 있어야함
2. 서버는 사용자에게 `고유한` 세션아이디를 부여해야함
3. 세션아이디(세션쿠키)는 `Expire` 만료날짜를 가져야함 왜냐하면 만약 세션쿠키를 해킹당한다면, 무기한으로 사용될 수 있기 때문임
4. 세션아이디는 일시적이고, `추측할 수 없어야함`
5. 세션아이디 자체에, 유저를 식별할 수 있는 정보를 담을 수 도 있음

### 쿠키의 key,value에는 `encodeURIComponent`를 사용하자

| 쿠키의 이름과 값엔 특별한 제약이 없기 때문에 모든 글자가 허용됩니다. 하지만 형식의 유효성을 일관성 있게 유지하기 위해 반드시 내장 함수 encodeURIComponent를 사용하여 이름과 값을 이스케이프 처리해 줘야 합니다.

```js
sessionId = SHA2(username + ipAddress + secretKey);
```

- 이 방법의 장점은 세션ID를 별도의 데이터베이스에 저장할 필요가 없다는 점입니다

좀더 안정적인 보안을 위해 난수를 섞어 생성할 수 도 있습니다

### 참고

1. [세션이란](https://devhaks.github.io/2019/04/20/session-strategy/)
